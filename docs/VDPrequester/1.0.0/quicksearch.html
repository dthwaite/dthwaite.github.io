<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"vdprequester.js.html":{"id":"vdprequester.js.html","title":"Source: vdprequester.js","body":" VDPrequester Modules VDPrequester Classes VDPrequester~VDPrequester Source: vdprequester.js /** * @file Job request functionality for connection to Volunteer Distributed Processing * @author Dominic Thwaites * @copyright (c) 2016 Dominic Thwaites dominicthwaites@mac.com * @licence MIT * @module VDPrequester */ module.exports=(/** @lends module:VDPrequester*/function() { /** * The maximum number of connections that can be made - set to 25. * Note that connections for completed jobs are re-used and thus new connections are only made as jobs are requested in parallel. * @type {number} * @const */ var MAX_CONNECTIONS=25; /** * Callback function template given when sending a job * * @callback requestCallback * @param {string} errorMessage Error message or null if no error * @param {(string|Blob|BufferArray)} resultData The data return from the job * @see VDPrequester#send */ /** * Class from which any and all cloud jobs are sent to a particular server. * * Note that connections to the server are only made upon job submission. Thus a bad server * address given here will not be immediately apparent. * * @param {string} address The URL complete with port number that is a VDP server (ws:// ...) * @throws {Error} if the address is not a websocket address * @constructor */ var VDPrequester=function(address) { if (typeof address=='string' &amp;&amp; address.substr(0,5)=='ws://') { this.url = address; // server URL this.libraries = {}; // VDPrequester holds a set of connections per library name } else throw new Error('Invalid server address'); }; /** * @returns {number} The number of connections open to the VDP server (max 25) */ VDPrequester.prototype.connectionCount=function() { var count=0; for (var library in this.libraries) { count+=this.libraries[library].length; } return count; }; /** * Sends a new job into the cloud. * * Generally, this is a fire and forget operation. There is no telling how long the job will take or when and who * will run the job. If you don't care (unlikely) then you need not provide a callback. But a callback is recommended * as it can tell about failures as well as the data results of the job. * * The library must be a valid name taken from the VDP repository. * * @param {string} library Name of the execution library to invoke * @param {string | Blob | bufferArray} data Input data to the library function * @param {requestCallback} [callback] Function called on completion of the job (passing error and result data as a parameter) */ VDPrequester.prototype.send=function(library,data, callback) { if (typeof callback!='function') callback=function() {}; this._send(new Request(library,data, callback,this)); }; /** * Cancels all outstanding job requests and closes all server connections. * * This can be used to clean up connections. Requests that have yet to complete are 'forgotten' * and thus no response will ever come back. However, those jobs are not cancelled and may or may not * complete in the cloud. This request object continues to be operative, however, allowing new requests * (and thus new connections) to be made to the server. */ VDPrequester.prototype.disconnect=function() { for (var library in this.libraries) { var list=this.libraries[library].slice(); for (var i=0; i&lt;list.length; i++) { list[i].available=true; list[i].close(); } } }; // Sends one request to the server over a spare connection or a new one if necessary VDPrequester.prototype._send=function(request) { if (!(request.library in this.libraries)) this.libraries[request.library]=[]; var list=this.libraries[request.library]; for (var i = 0; i &lt; list.length; i++) { if (list[i].available) { request.resetSocket(list[i]).send(request.data); return; } } if (this.connectionCount()&gt;=MAX_CONNECTIONS) { request.callback('Maximum connection count reached'); } try { list[i] = request.resetSocket(new WebSocket(this.url, 'R' + request.library)); list[i].onopen = function() { list[i].send(request.data); }; } catch (error) { request.callback('Connection to server refused'); } }; // Represents one job request var Request=function(library,data, callback,vdprequester) { this.library=library; this.data = data; this.vdprequester = vdprequester; this.callback = callback; this.errors=0; }; // Sets the socket's callbacks in the context of this request Request.prototype.resetSocket=function(socket) { socket.available=false; var me=this; socket.onclose=function() { var list=me.vdprequester.libraries[me.library]; // Remove this socket from our store list.splice(list.indexOf(socket),1); // Resend if we never got a response if (me.errors&gt;0) { if (me.errors&gt;12) me.callback('Server consistently unavailable'); else { setTimeout(function() { me.vdprequester._send(me); }, 5000); } } else { // Server purposefully closed this connection - meaning that // the message sent was not acceptable if (!socket.available) me.callback('Server closed your connection'); } }; socket.onmessage=function(event) { // flag as complete and send the data to the user socket.available = true; me.callback(null,event.data); }; socket.onerror=function() { me.errors++; }; return socket; }; return VDPrequester; })(); × Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" VDPrequester Modules VDPrequester Classes VDPrequester~VDPrequester Modules Classes VDPrequester × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" VDPrequester Modules VDPrequester Classes VDPrequester~VDPrequester Classes Classes VDPrequester × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" VDPrequester Modules VDPrequester Classes VDPrequester~VDPrequester VDPrequester 1.0.0 VDPrequester Requests jobs to be run in the cloud on volunteer computersAvailable on GitHub, details on JSDocs. This is a very simple library that allows you to submit jobs into my experimental Volunteer Distributed Processing (VDP) network.It is specific to this network and has no generic applicability. Node.js:To install it:npm install VDPrequester To see how to use it:npm docs To code with it: var vdprequester=new VDPrequester('ws://127.0.0.1:8080'); var square=21; vdprequester.send(square,'squareroot',function(error,result) { 'The square root of '+square+' is '+result.data; });Browser:To install it: Download vdprequester.min.js from GitHub or use their CDN for my latest version: v1.0.0 vdprequester.min.js is a UMD (Universal Module Definition) bundle with an export name of VDPrequester To code with it: &lt;script&gt; var vdprequester=new VDPrequester('ws://127.0.0.1:8080'); var square=21; vdprequester.send(square,'squareroot',function(error,result) { 'The square root of '+square+' is '+result.data; }); &lt;/script&gt;Development:Lint (to ensure no eslint issues):npm run lint Build minified version for browser into lib/vdprequester.min.js:npm run build-prod Build and run test for browser testing and debugging:npm test Build and run test with coverage:npm run test-coverage Review coverage:npm run view-coverage (after npm-run test-coverage) × Search results Close "},"module-VDPrequester.html":{"id":"module-VDPrequester.html","title":"Module: VDPrequester","body":" VDPrequester Modules VDPrequester Classes VDPrequester~VDPrequester Module: VDPrequester Job request functionality for connection to Volunteer Distributed Processing Author: Dominic Thwaites Copyright: (c) 2016 Dominic Thwaites dominicthwaites@mac.com Source: vdprequester.js, line 1 Classes VDPrequester Members &lt;inner, constant&gt; MAX_CONNECTIONS :number The maximum number of connections that can be made - set to 25.Note that connections for completed jobs are re-used and thus new connections are only made as jobs are requested in parallel. Type: number Source: vdprequester.js, line 15 Type Definitions requestCallback(errorMessage, resultData) Callback function template given when sending a job Parameters: Name Type Description errorMessage string Error message or null if no error resultData string | Blob | BufferArray The data return from the job Source: vdprequester.js, line 17 See: VDPrequester#send × Search results Close "},"module-VDPrequester-VDPrequester.html":{"id":"module-VDPrequester-VDPrequester.html","title":"Class: VDPrequester","body":" VDPrequester Modules VDPrequester Classes VDPrequester~VDPrequester Class: VDPrequester VDPrequester~ VDPrequester new VDPrequester(address) Class from which any and all cloud jobs are sent to a particular server. Note that connections to the server are only made upon job submission. Thus a bad serveraddress given here will not be immediately apparent. Parameters: Name Type Description address string The URL complete with port number that is a VDP server (ws:// ...) Source: vdprequester.js, line 36 Throws: if the address is not a websocket address Type Error Methods connectionCount() Source: vdprequester.js, line 46 Returns: The number of connections open to the VDP server (max 25) Type number disconnect() Cancels all outstanding job requests and closes all server connections. This can be used to clean up connections. Requests that have yet to complete are 'forgotten'and thus no response will ever come back. However, those jobs are not cancelled and may or may notcomplete in the cloud. This request object continues to be operative, however, allowing new requests(and thus new connections) to be made to the server. Source: vdprequester.js, line 80 send(library, data, callback) Sends a new job into the cloud. Generally, this is a fire and forget operation. There is no telling how long the job will take or when and whowill run the job. If you don't care (unlikely) then you need not provide a callback. But a callback is recommendedas it can tell about failures as well as the data results of the job. The library must be a valid name taken from the VDP repository. Parameters: Name Type Argument Description library string Name of the execution library to invoke data string | Blob | bufferArray Input data to the library function callback requestCallback &lt;optional&gt; Function called on completion of the job (passing error and result data as a parameter) Source: vdprequester.js, line 67 × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
